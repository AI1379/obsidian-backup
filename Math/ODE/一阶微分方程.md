---
tags:
  - ODE
---

## 齐次方程

若 $f(x,y)$ 为零次齐次函数，即满足 $f(tx,ty)=f(x,y)$ ，则称微分方程
$$
y' = f(x,y)
$$
为**齐次方程**。此时可以考虑做变量代换：$u = \frac{y}{x}$ ，化为可分离变量的方程。**注意区分线性齐次方程与齐次方程，注意这里必须是零次的齐次函数**。

## 恰当方程

考虑平面 $\mathbb{R}^2$ 上的区域 $G$ ，若在 $G$ 上存在一个具有一阶连续偏导的二元函数 $F(x,y)$ 使得：

$$
\mathrm{d}F(x,y) = M(x,y)\mathrm{d}x+N(x,y)+\mathrm{d}y
$$
则称一阶微分方程：

$$
M(x,y)\mathrm{d}x+N(x,y)\mathrm{d}y=0
$$

被称作区域 $G$ 内的全微分方程，即恰当方程。此时显然有隐函数形式的原方程的解 $F(x,y)=0$ 。从而若一个方程是恰当的，那么可以容易的利用初等积分法求得 $F(x,y)$ 进而求得原方程隐函数形式的解。

注意到若函数 $M,N$ 均有一阶连续偏导数，那么函数 $F$ 一定有二阶连续偏导，从而有：

$$
\frac{\partial M}{\partial y} = \frac{\partial^2F}{\partial x\partial y} = \frac{\partial N}{\partial x}
$$
从而可以给出一个一阶微分方程为恰当方程的充要条件。

## 积分因子法

对于一些非恰当的方程，一个自然的想法就是考虑将它转化为一个恰当方程，这个时候有一个容易想到的想法就是在方程两端同时乘上一个函数 $\mu(x,y)$ ，使得 $\mu M$ 和 $\mu N$ 满足恰当方程的条件，这与常数变易法的思路是一致的。这样的函数被称作**积分因子**。

从而容易得到一个函数是积分因子的充要条件：

$$
\frac{1}{\mu} \left( N \frac{ \partial \mu }{ \partial x } - M \frac{ \partial \mu }{ \partial y } \right) = \frac{ \partial M }{ \partial y } -\frac{ \partial N }{ \partial x } 
$$

这是一个关于 $\mu$ 的偏微分方程，但是在某些情况下它确实会原本的常微分方程更容易求解，譬如当 $\mu$ 只与 $x$ 或 $y$ 有关的时候。以下举几个例子。

### 只与 $x$ 有关的积分因子

此时条件可以化为

$$
\frac{1}{\mu} \frac{ \mathrm{d} \mu }{ \mathrm{d} x } = \frac{\frac{ \partial M }{ \partial y } - \frac{ \partial N }{ \partial x } }{N}
$$
左侧只与 $x$ 有关，从而右侧也应该只与 $x$ 有关，从而可以得到积分因子只与 $x$ 有关的充要条件是等式右侧只与 $x$ 有关。从而得到：

$$
\ln(\mu(x)) = \int_{x_{0}}^x \frac{\frac{ \partial M }{ \partial y } - \frac{ \partial N }{ \partial x } }{N} \mathrm{d}x
$$

### 与 $x+y$ 有关的积分因子

此时有 $\frac{ \partial \mu }{ \partial x } = \frac{ \mathrm{d} \mu }{ \mathrm{d} t }\frac{ \partial t }{ \partial x } = \frac{ \mathrm{d} \mu }{ \mathrm{d} t } = \mu’(x+y)$ 。从而可以得到：

$$
\frac{\mu’(x+y)}{\mu(x+y)} (N-M) = \frac{ \partial M }{ \partial y } -\frac{ \partial N }{ \partial x } 
$$

移项同理可得。

### 与 $xy$ 有关的积分因子

此时有：

$$
\frac{1}{\mu(xy)} \left( Ny\mu’(xy) - M x \mu’(xy) \right) = \frac{\mu’(xy)}{\mu (xy)} (yN-xM) = \frac{ \partial M }{ \partial y } - \frac{ \partial N }{ \partial x } 
$$

同理可得积分因子 $\mu$

### 分组求积分因子

TODO

## 特殊的可以求解的一阶非线性 ODE

### Bernoulli 方程

$$
y' + g(x)y + h(x)y^\alpha = 0,\quad \alpha \neq 0, 1
$$
此时左右两边可以同乘因子 $(1-\alpha)y^{-\alpha}$ 得到：
$$
(y^{1-\alpha})' + (1-\alpha)g(x)y^{1-\alpha} + (1-\alpha)h(x) = 0
$$
经过换元 $z=y^{1-\alpha}$ 可以化为一阶线性 ODE。注意，显然原方程有特解 $y=0$ ，

### Riccati 方程

$$
y'+g(x)y+h(x)y^2=k(x)
$$

对于这样的方程很难给出一般的求解，但是若已经有了一个特解 $\phi(x)$ ，则可以做变量代换 $u(x)=y(x)-\phi(x)$ 得到一个 Bernoulli 方程。

## 参数法

考虑一阶非线性微分方程 $F\left( x,y,\frac{dy}{dx} \right)$ ，考虑参数化 $p=\frac{dy}{dx}$ ，可以得到方程：
$$
\begin{cases}
F(x,y,p) = 0 \\
\mathrm{d}y = p\mathrm{d}x \\
\end{cases}
$$
从而化简方程。这个参数化不是唯一的方案，可以任意进行。

---

# 相关条目

[[奇解]]

# 待定系数法

---

## 🤖 Assistant

## 一、待定系数法总结（Method of Undetermined Coefficients）

待定系数法适用于**常系数线性微分方程**，非齐次项必须是以下函数类型及其组合：

- 多项式
- 指数函数 $e^{\alpha x}$
- 正弦函数 $\sin \beta x$ 和余弦函数 $\cos \beta x$
- 这些函数的乘积与线性组合

**核心原则：根据非齐次项形式，假设特解具有相似结构，并乘以适当的幂次 $x^k$ 以避开齐次解。**

---

## 二、特解形式速查表

设方程特征根为 $r$（考虑重数）

| 非齐次项类型                     | 特解的一般形式（假设）                                | $k$ 的取值规则                              |
|-------------------------------|---------------------------------------------------|---------------------------------------------|
| $P_n(x)$（多项式）            | $x^k Q_n(x)$                                    | $k=$ 0的重数（0不是根则 $k=0$）            |
| $e^{\alpha x}$               | $A x^k e^{\alpha x}$                            | $k=$ $\alpha$的重数（不是根则 $k=0$）    |
| $\sin \beta x$ 或 $\cos \beta x$ | $x^k [A \cos \beta x + B \sin \beta x]$        | $k=$ $\pm i\beta$的重数（不是根则 $k=0$） |
| $P_n(x)e^{\alpha x}$        | $x^k Q_n(x)e^{\alpha x}$                        | $k=$ $\alpha$的重数                       |
| $e^{\alpha x}\sin \beta x$ 或 $e^{\alpha x}\cos \beta x$ | $x^k e^{\alpha x}[A\cos\beta x + B\sin\beta x]$ | $k=$ $\alpha \pm i\beta$的重数            |
| $P_n(x)\sin \beta x$ 或 $P_n(x)\cos \beta x$ | $x^k [Q_n(x)\cos\beta x + R_n(x)\sin\beta x]$   | $k=$ $\pm i\beta$的重数                   |

**说明**：
- $P_n(x)$、$Q_n(x)$、$R_n(x)$ 均为 $n$ 次多项式（系数待定）
- $A, B$ 为待定常数
- $k$ 的选择原则：使所设特解与齐次解线性无关（若特解中有与齐次解相同的项，则乘以 $x^k$ 直到不同为止）

---

## 三、重要注意事项

1. **叠加原理**：若非齐次项由多个上述类型相加，则分别对每一部分假设特解，然后相加作为整个特解（注意各部分分别乘以各自的 $x^k$ 避免与齐次解重复）。

2. **避免重复的关键**：  
   - 先写出齐次通解  
   - 如果非齐次项的“基本形式”（不含 $x^k$ 因子的部分）出现在齐次解中，则乘以 $x^k$，其中 $k$ 是该特征根的重数。

3. **特例处理**：  
   - 若同时出现 $\sin \beta x$ 和 $\cos \beta x$，即使只有其中一个，特解中也要同时包含两项。  
   - 对于多项式与其他函数的乘积，多项式的次数必须完整保留。

---

## 四、解题流程示例

以方程 $y'' - 2y' + y = xe^x$ 为例：

1. **求齐次解**：特征方程 $r^2 - 2r + 1 = 0$，解得 $r = 1$（二重根），齐次解 $y_h = (C_1 + C_2 x)e^x$。

2. **分析非齐次项**：$xe^x$ 属于 $P_n(x)e^{\alpha x}$ 类型，其中 $\alpha = 1$，$n = 1$。

3. **设定特解**：
   - 因为 $\alpha = 1$ 是二重特征根，取 $k = 2$（重数）。
   - 故设 $y_p = x^2 (Ax + B)e^x = (Ax^3 + Bx^2)e^x$。

4. **代入方程求系数**：计算 $y_p'$ 和 $y_p''$，代入方程，比较系数解出 $A = \frac{1}{6}, B = 0$（具体过程略）。

5. **最终通解**：$y = y_h + y_p = (C_1 + C_2 x)e^x + \frac{1}{6}x^3 e^x$。

---

## 五、适用范围提醒

待定系数法仅适用于**常系数线性方程**。对于变系数线性方程，一般使用**常数变易法**。对于欧拉方程，则先通过代换 $x = e^t$ 转化为常系数方程，再按上述方法处理。
